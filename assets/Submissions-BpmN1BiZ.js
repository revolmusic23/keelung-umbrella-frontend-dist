import{p as j,e as l,f as L,r as c,o as _,c as X,w as n,a as u,b as d,d as M,l as F,m as G,q,h,t as w,j as V,F as E}from"./index-C5Y_fbBl.js";import{s as S}from"./services-MGYLFbSm.js";const R={class:"d-flex ga-4 mb-2 mr-2"},T={__name:"DeleteSubmissionModal",props:{showModal:Boolean},emits:["update:showModal","confirm"],setup(B,{emit:C}){j();const x=B,r=C,t=l(!1);L(()=>x.showModal,a=>{t.value=a}),L(t,a=>{r("update:showModal",a)});const v=()=>{r("confirm"),t.value=!1};return(a,e)=>{const m=c("v-btn"),f=c("XBaseModal");return _(),X(f,{modelValue:t.value,"onUpdate:modelValue":e[1]||(e[1]=b=>t.value=b)},{title:n(()=>e[2]||(e[2]=[u("div",{class:"ml-4 mt-2"},"刪除作品",-1)])),text:n(()=>e[3]||(e[3]=[u("div",{class:"ml-2"},"刪除後將無法復原，確定要刪除嗎？",-1)])),actions:n(()=>[u("div",R,[d(m,{class:"btn-red",onClick:v},{default:n(()=>e[4]||(e[4]=[M("確認")])),_:1}),d(m,{variant:"outlined",class:"",onClick:e[0]||(e[0]=b=>t.value=!1)},{default:n(()=>e[5]||(e[5]=[M("取消")])),_:1})])]),_:1},8,["modelValue"])}}},z={class:"text-center d-flex justify-center align-center ga-2 my-4"},A={key:0,class:"page-info mb-4"},H={key:1},P={__name:"Submissions",setup(B){const C=F(),x=G(()=>C.state.isLoading),r=l(!1);l(!1);const t=l(""),v=l({name:"",phone:"",email:""}),a=l([]),e=l(""),m=l(""),f=async()=>{m.value="",a.value=[];const o={phone:t.value},[s,p]=await S.getSubmissions(o);p?(b(p),console.log(p)):m.value=s},b=o=>{a.value=o.items,console.log("submissionsList:",a.value),v.value={name:o.name,phone:o.phone,email:o.email},e.value=o.detaching_id},I=async o=>{r.value=!0;const s={detaching_id:e.value,image_uuid:k.value},[p,g]=await S.deleteImage(s);g&&(console.log(g),f()),r.value=!1},k=l(""),y=q({delete:!1}),D={delete:o=>{y.delete=!0,k.value=o}};return(o,s)=>{const p=c("v-text-field"),g=c("v-btn"),N=c("XLoadingCircle"),$=c("XCardImage"),U=c("XBaseGridLayout");return _(),h(E,null,[s[4]||(s[4]=u("h1",{class:"page-title"},"個人提交作品",-1)),u("div",z,[d(p,{modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=i=>t.value=i),label:"請輸入手機號碼",density:"compact",variant:"outlined","hide-details":"","max-width":"600"},null,8,["modelValue"]),d(g,{class:"btn-orange",onClick:f},{default:n(()=>s[2]||(s[2]=[M("查詢")])),_:1})]),a.value.length>0?(_(),h("div",A,[u("p",null,"姓名："+w(v.value.name),1),u("p",null,"手機號碼："+w(v.value.phone),1),u("p",null,"電子郵件："+w(v.value.email),1)])):V("",!0),m.value?(_(),h("p",H,w(m.value),1)):V("",!0),x.value&&!r.value?(_(),X(N,{key:2})):V("",!0),d(U,{cards:a.value},{card:n(({item:i})=>[d($,{imgSrc:i.images[0].image_path,description:i.description},{actions:n(()=>[d(g,{onClick:J=>D.delete(i.uuid),loading:r.value&&i.uuid===k.value,class:"btn-red"},{default:n(()=>s[3]||(s[3]=[M(" 刪除 ")])),_:2},1032,["onClick","loading"])]),_:2},1032,["imgSrc","description"])]),_:1},8,["cards"]),d(T,{showModal:y.delete,"onUpdate:showModal":s[1]||(s[1]=i=>y.delete=i),onConfirm:I},null,8,["showModal"])],64)}}};export{P as default};
