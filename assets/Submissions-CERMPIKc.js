import{s as I,p as N,e as a,r as i,o as p,h as f,a as c,b as r,w as g,t as v,j as b,c as M,F as j,d as C,v as D}from"./index-Bt-L2twE.js";import{s as k}from"./services-vMF6gtvx.js";const F={class:"text-center d-flex justify-center align-center ga-2 my-4"},G={key:0,class:"page-info mb-4"},E={key:1},z={__name:"Submissions",setup(T){const x=I(),L=N(()=>x.state.isLoading),u=a(!1);a(!1);const _=a(""),d=a({name:"",phone:"",email:""}),o=a([]),h=a(""),m=a(""),y=async()=>{m.value="",o.value=[];const s={nid:_.value},[e,t]=await k.getSubmissions(s);t?(S(t),console.log(t)):m.value=e},S=s=>{o.value=s.items,console.log("submissionsList:",o.value),d.value={name:s.name,phone:s.phone,email:s.email},h.value=s.detaching_id},V=async s=>{u.value=!0;const e={detaching_id:h.value,image_uuid:s},[t,n]=await k.deleteImage(e);n&&(console.log(n),y()),u.value=!1};return(s,e)=>{const t=i("v-text-field"),n=i("v-btn"),w=i("XLoadingCircle"),B=i("XCardImage"),X=i("XBaseGridLayout");return p(),f(j,null,[e[3]||(e[3]=c("h1",{class:"page-title"},"個人提交作品",-1)),c("div",F,[r(t,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=l=>_.value=l),label:"請輸入身分證字號",density:"compact",variant:"outlined","hide-details":"","max-width":"600"},null,8,["modelValue"]),r(n,{class:"btn-orange",onClick:y},{default:g(()=>e[1]||(e[1]=[C("查詢")])),_:1})]),o.value.length>0?(p(),f("div",G,[c("p",null,"姓名："+v(d.value.name),1),c("p",null,"手機號碼："+v(d.value.phone),1),c("p",null,"電子郵件："+v(d.value.email),1)])):b("",!0),m.value?(p(),f("p",E,v(m.value),1)):b("",!0),L.value&&!u.value?(p(),M(w,{key:2})):b("",!0),r(X,{cards:o.value},{card:g(({item:l})=>[r(B,{imgSrc:l.images[0].image_path,description:l.description},{actions:g(()=>[r(n,{onClick:D(U=>V(l.uuid),["stop"]),loading:u.value,class:"btn-red"},{default:g(()=>e[2]||(e[2]=[C(" 刪除 ")])),_:2},1032,["onClick","loading"])]),_:2},1032,["imgSrc","description"])]),_:1},8,["cards"])],64)}}};export{z as default};
