import{_ as H,e as D,r as w,o as E,c as V,w as b,f as O,F as $,g as J,b as R,d as A,t as B,h as q,a as x,u as F,i as G,j as re,k as ne,l as z,m as ee,n as ie,p as ae}from"./index-BLFh__II.js";import{s as se}from"./services-CyPq6jF0.js";import{c as ue}from"./cors-anywhere-CZnAS8i4.js";var Z={exports:{}};/*!
 * validate.js 0.13.1
 *
 * (c) 2013-2019 Nicklas Ansman, 2013 Wrapp
 * Validate.js may be freely distributed under the MIT license.
 * For all details and documentation:
 * http://validatejs.org/
 */(function(f,g){(function(S,p,h){var d=function(e,t,n){n=r.extend({},r.options,n);var a=r.runValidations(e,t,n);if(a.some(function(s){return r.isPromise(s.error)}))throw new Error("Use validate.async if you want support for promises");return d.processValidationResults(a,n)},r=d;r.extend=function(e){return[].slice.call(arguments,1).forEach(function(t){for(var n in t)e[n]=t[n]}),e},r.extend(d,{version:{major:0,minor:13,patch:1,metadata:null,toString:function(){var e=r.format("%{major}.%{minor}.%{patch}",r.version);return r.isEmpty(r.version.metadata)||(e+="+"+r.version.metadata),e}},Promise:typeof Promise<"u"?Promise:null,EMPTY_STRING_REGEXP:/^\s*$/,runValidations:function(e,t,n){var a=[],s,i,o,u,l,c,m;(r.isDomElement(e)||r.isJqueryElement(e))&&(e=r.collectFormValues(e));for(s in t){o=r.getDeepObjectValue(e,s),u=r.result(t[s],o,e,s,n,t);for(i in u){if(l=r.validators[i],!l)throw m=r.format("Unknown validator %{name}",{name:i}),new Error(m);c=u[i],c=r.result(c,o,e,s,n,t),c&&a.push({attribute:s,value:o,validator:i,globalOptions:n,attributes:e,options:c,error:l.call(l,o,c,s,e,n)})}}return a},processValidationResults:function(e,t){e=r.pruneEmptyErrors(e,t),e=r.expandMultipleErrors(e,t),e=r.convertErrorMessages(e,t);var n=t.format||"grouped";if(typeof r.formatters[n]=="function")e=r.formatters[n](e);else throw new Error(r.format("Unknown format %{format}",t));return r.isEmpty(e)?void 0:e},async:function(e,t,n){n=r.extend({},r.async.options,n);var a=n.wrapErrors||function(i){return i};n.cleanAttributes!==!1&&(e=r.cleanAttributes(e,t));var s=r.runValidations(e,t,n);return new r.Promise(function(i,o){r.waitForResults(s).then(function(){var u=r.processValidationResults(s,n);u?o(new a(u,n,e,t)):i(e)},function(u){o(u)})})},single:function(e,t,n){return n=r.extend({},r.single.options,n,{format:"flat",fullMessages:!1}),r({single:e},{single:t},n)},waitForResults:function(e){return e.reduce(function(t,n){return r.isPromise(n.error)?t.then(function(){return n.error.then(function(a){n.error=a||null})}):t},new r.Promise(function(t){t()}))},result:function(e){var t=[].slice.call(arguments,1);return typeof e=="function"&&(e=e.apply(null,t)),e},isNumber:function(e){return typeof e=="number"&&!isNaN(e)},isFunction:function(e){return typeof e=="function"},isInteger:function(e){return r.isNumber(e)&&e%1===0},isBoolean:function(e){return typeof e=="boolean"},isObject:function(e){return e===Object(e)},isDate:function(e){return e instanceof Date},isDefined:function(e){return e!=null},isPromise:function(e){return!!e&&r.isFunction(e.then)},isJqueryElement:function(e){return e&&r.isString(e.jquery)},isDomElement:function(e){return!e||!e.querySelectorAll||!e.querySelector?!1:r.isObject(document)&&e===document?!0:typeof HTMLElement=="object"?e instanceof HTMLElement:e&&typeof e=="object"&&e!==null&&e.nodeType===1&&typeof e.nodeName=="string"},isEmpty:function(e){var t;if(!r.isDefined(e))return!0;if(r.isFunction(e))return!1;if(r.isString(e))return r.EMPTY_STRING_REGEXP.test(e);if(r.isArray(e))return e.length===0;if(r.isDate(e))return!1;if(r.isObject(e)){for(t in e)return!1;return!0}return!1},format:r.extend(function(e,t){return r.isString(e)?e.replace(r.format.FORMAT_REGEXP,function(n,a,s){return a==="%"?"%{"+s+"}":String(t[s])}):e},{FORMAT_REGEXP:/(%?)%\{([^\}]+)\}/g}),prettify:function(e){return r.isNumber(e)?e*100%1===0?""+e:parseFloat(Math.round(e*100)/100).toFixed(2):r.isArray(e)?e.map(function(t){return r.prettify(t)}).join(", "):r.isObject(e)?r.isDefined(e.toString)?e.toString():JSON.stringify(e):(e=""+e,e.replace(/([^\s])\.([^\s])/g,"$1 $2").replace(/\\+/g,"").replace(/[_-]/g," ").replace(/([a-z])([A-Z])/g,function(t,n,a){return""+n+" "+a.toLowerCase()}).toLowerCase())},stringifyValue:function(e,t){var n=t&&t.prettify||r.prettify;return n(e)},isString:function(e){return typeof e=="string"},isArray:function(e){return{}.toString.call(e)==="[object Array]"},isHash:function(e){return r.isObject(e)&&!r.isArray(e)&&!r.isFunction(e)},contains:function(e,t){return r.isDefined(e)?r.isArray(e)?e.indexOf(t)!==-1:t in e:!1},unique:function(e){return r.isArray(e)?e.filter(function(t,n,a){return a.indexOf(t)==n}):e},forEachKeyInKeypath:function(e,t,n){if(r.isString(t)){var a="",s,i=!1;for(s=0;s<t.length;++s)switch(t[s]){case".":i?(i=!1,a+="."):(e=n(e,a,!1),a="");break;case"\\":i?(i=!1,a+="\\"):i=!0;break;default:i=!1,a+=t[s];break}return n(e,a,!0)}},getDeepObjectValue:function(e,t){if(r.isObject(e))return r.forEachKeyInKeypath(e,t,function(n,a){if(r.isObject(n))return n[a]})},collectFormValues:function(e,t){var n={},a,s,i,o,u,l;if(r.isJqueryElement(e)&&(e=e[0]),!e)return n;for(t=t||{},o=e.querySelectorAll("input[name], textarea[name]"),a=0;a<o.length;++a)if(i=o.item(a),!r.isDefined(i.getAttribute("data-ignored"))){var c=i.name.replace(/\./g,"\\\\.");l=r.sanitizeFormValue(i.value,t),i.type==="number"?l=l?+l:null:i.type==="checkbox"?i.attributes.value?i.checked||(l=n[c]||null):l=i.checked:i.type==="radio"&&(i.checked||(l=n[c]||null)),n[c]=l}for(o=e.querySelectorAll("select[name]"),a=0;a<o.length;++a)if(i=o.item(a),!r.isDefined(i.getAttribute("data-ignored"))){if(i.multiple){l=[];for(s in i.options)u=i.options[s],u&&u.selected&&l.push(r.sanitizeFormValue(u.value,t))}else{var m=typeof i.options[i.selectedIndex]<"u"?i.options[i.selectedIndex].value:"";l=r.sanitizeFormValue(m,t)}n[i.name]=l}return n},sanitizeFormValue:function(e,t){return t.trim&&r.isString(e)&&(e=e.trim()),t.nullify!==!1&&e===""?null:e},capitalize:function(e){return r.isString(e)?e[0].toUpperCase()+e.slice(1):e},pruneEmptyErrors:function(e){return e.filter(function(t){return!r.isEmpty(t.error)})},expandMultipleErrors:function(e){var t=[];return e.forEach(function(n){r.isArray(n.error)?n.error.forEach(function(a){t.push(r.extend({},n,{error:a}))}):t.push(n)}),t},convertErrorMessages:function(e,t){t=t||{};var n=[],a=t.prettify||r.prettify;return e.forEach(function(s){var i=r.result(s.error,s.value,s.attribute,s.options,s.attributes,s.globalOptions);if(!r.isString(i)){n.push(s);return}i[0]==="^"?i=i.slice(1):t.fullMessages!==!1&&(i=r.capitalize(a(s.attribute))+" "+i),i=i.replace(/\\\^/g,"^"),i=r.format(i,{value:r.stringifyValue(s.value,t)}),n.push(r.extend({},s,{error:i}))}),n},groupErrorsByAttribute:function(e){var t={};return e.forEach(function(n){var a=t[n.attribute];a?a.push(n):t[n.attribute]=[n]}),t},flattenErrorsToArray:function(e){return e.map(function(t){return t.error}).filter(function(t,n,a){return a.indexOf(t)===n})},cleanAttributes:function(e,t){function n(i,o,u){return r.isObject(i[o])?i[o]:i[o]=u?!0:{}}function a(i){var o={},u;for(u in i)i[u]&&r.forEachKeyInKeypath(o,u,n);return o}function s(i,o){if(!r.isObject(i))return i;var u=r.extend({},i),l,c;for(c in i)l=o[c],r.isObject(l)?u[c]=s(u[c],l):l||delete u[c];return u}return!r.isObject(t)||!r.isObject(e)?{}:(t=a(t),s(e,t))},exposeModule:function(e,t,n,a,s){n?(a&&a.exports&&(n=a.exports=e),n.validate=e):(t.validate=e,e.isFunction(s)&&s.amd&&s([],function(){return e}))},warn:function(e){typeof console<"u"&&console.warn&&console.warn("[validate.js] "+e)},error:function(e){typeof console<"u"&&console.error&&console.error("[validate.js] "+e)}}),d.validators={presence:function(e,t){if(t=r.extend({},this.options,t),t.allowEmpty!==!1?!r.isDefined(e):r.isEmpty(e))return t.message||this.message||"can't be blank"},length:function(e,t,n){if(r.isDefined(e)){t=r.extend({},this.options,t);var a=t.is,s=t.maximum,i=t.minimum,o=t.tokenizer||function(m){return m},u,l=[];e=o(e);var c=e.length;if(!r.isNumber(c))return t.message||this.notValid||"has an incorrect length";if(r.isNumber(a)&&c!==a&&(u=t.wrongLength||this.wrongLength||"is the wrong length (should be %{count} characters)",l.push(r.format(u,{count:a}))),r.isNumber(i)&&c<i&&(u=t.tooShort||this.tooShort||"is too short (minimum is %{count} characters)",l.push(r.format(u,{count:i}))),r.isNumber(s)&&c>s&&(u=t.tooLong||this.tooLong||"is too long (maximum is %{count} characters)",l.push(r.format(u,{count:s}))),l.length>0)return t.message||l}},numericality:function(e,t,n,a,s){if(r.isDefined(e)){t=r.extend({},this.options,t);var i=[],o,u,l={greaterThan:function(_,v){return _>v},greaterThanOrEqualTo:function(_,v){return _>=v},equalTo:function(_,v){return _===v},lessThan:function(_,v){return _<v},lessThanOrEqualTo:function(_,v){return _<=v},divisibleBy:function(_,v){return _%v===0}},c=t.prettify||s&&s.prettify||r.prettify;if(r.isString(e)&&t.strict){var m="^-?(0|[1-9]\\d*)";if(t.onlyInteger||(m+="(\\.\\d+)?"),m+="$",!new RegExp(m).test(e))return t.message||t.notValid||this.notValid||this.message||"must be a valid number"}if(t.noStrings!==!0&&r.isString(e)&&!r.isEmpty(e)&&(e=+e),!r.isNumber(e))return t.message||t.notValid||this.notValid||this.message||"is not a number";if(t.onlyInteger&&!r.isInteger(e))return t.message||t.notInteger||this.notInteger||this.message||"must be an integer";for(o in l)if(u=t[o],r.isNumber(u)&&!l[o](e,u)){var y="not"+r.capitalize(o),N=t[y]||this[y]||this.message||"must be %{type} %{count}";i.push(r.format(N,{count:u,type:c(o)}))}if(t.odd&&e%2!==1&&i.push(t.notOdd||this.notOdd||this.message||"must be odd"),t.even&&e%2!==0&&i.push(t.notEven||this.notEven||this.message||"must be even"),i.length)return t.message||i}},datetime:r.extend(function(e,t){if(!r.isFunction(this.parse)||!r.isFunction(this.format))throw new Error("Both the parse and format functions needs to be set to use the datetime/date validator");if(r.isDefined(e)){t=r.extend({},this.options,t);var n,a=[],s=t.earliest?this.parse(t.earliest,t):NaN,i=t.latest?this.parse(t.latest,t):NaN;if(e=this.parse(e,t),isNaN(e)||t.dateOnly&&e%864e5!==0)return n=t.notValid||t.message||this.notValid||"must be a valid date",r.format(n,{value:arguments[0]});if(!isNaN(s)&&e<s&&(n=t.tooEarly||t.message||this.tooEarly||"must be no earlier than %{date}",n=r.format(n,{value:this.format(e,t),date:this.format(s,t)}),a.push(n)),!isNaN(i)&&e>i&&(n=t.tooLate||t.message||this.tooLate||"must be no later than %{date}",n=r.format(n,{date:this.format(i,t),value:this.format(e,t)}),a.push(n)),a.length)return r.unique(a)}},{parse:null,format:null}),date:function(e,t){return t=r.extend({},t,{dateOnly:!0}),r.validators.datetime.call(r.validators.datetime,e,t)},format:function(e,t){(r.isString(t)||t instanceof RegExp)&&(t={pattern:t}),t=r.extend({},this.options,t);var n=t.message||this.message||"is invalid",a=t.pattern,s;if(r.isDefined(e)&&(!r.isString(e)||(r.isString(a)&&(a=new RegExp(t.pattern,t.flags)),s=a.exec(e),!s||s[0].length!=e.length)))return n},inclusion:function(e,t){if(r.isDefined(e)&&(r.isArray(t)&&(t={within:t}),t=r.extend({},this.options,t),!r.contains(t.within,e))){var n=t.message||this.message||"^%{value} is not included in the list";return r.format(n,{value:e})}},exclusion:function(e,t){if(r.isDefined(e)&&(r.isArray(t)&&(t={within:t}),t=r.extend({},this.options,t),!!r.contains(t.within,e))){var n=t.message||this.message||"^%{value} is restricted";return r.isString(t.within[e])&&(e=t.within[e]),r.format(n,{value:e})}},email:r.extend(function(e,t){t=r.extend({},this.options,t);var n=t.message||this.message||"is not a valid email";if(r.isDefined(e)&&(!r.isString(e)||!this.PATTERN.exec(e)))return n},{PATTERN:/^(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i}),equality:function(e,t,n,a,s){if(r.isDefined(e)){r.isString(t)&&(t={attribute:t}),t=r.extend({},this.options,t);var i=t.message||this.message||"is not equal to %{attribute}";if(r.isEmpty(t.attribute)||!r.isString(t.attribute))throw new Error("The attribute must be a non empty string");var o=r.getDeepObjectValue(a,t.attribute),u=t.comparator||function(c,m){return c===m},l=t.prettify||s&&s.prettify||r.prettify;if(!u(e,o,t,n,a))return r.format(i,{attribute:l(t.attribute)})}},url:function(e,t){if(r.isDefined(e)){t=r.extend({},this.options,t);var n=t.message||this.message||"is not a valid url",a=t.schemes||this.schemes||["http","https"],s=t.allowLocal||this.allowLocal||!1,i=t.allowDataUrl||this.allowDataUrl||!1;if(!r.isString(e))return n;var o="^(?:(?:"+a.join("|")+")://)(?:\\S+(?::\\S*)?@)?(?:",u="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))";if(s?u+="?":o+="(?!(?:10|127)(?:\\.\\d{1,3}){3})(?!(?:169\\.254|192\\.168)(?:\\.\\d{1,3}){2})(?!172\\.(?:1[6-9]|2\\d|3[0-1])(?:\\.\\d{1,3}){2})",o+="(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(?:(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*"+u+")(?::\\d{2,5})?(?:[/?#]\\S*)?$",i){var l="\\w+\\/[-+.\\w]+(?:;[\\w=]+)*",c="[A-Za-z0-9-_.!~\\*'();\\/?:@&=+$,%]*",m="data:(?:"+l+")?(?:;base64)?,"+c;o="(?:"+o+")|(?:^"+m+"$)"}var y=new RegExp(o,"i");if(!y.exec(e))return n}},type:r.extend(function(e,t,n,a,s){if(r.isString(t)&&(t={type:t}),!!r.isDefined(e)){var i=r.extend({},this.options,t),o=i.type;if(!r.isDefined(o))throw new Error("No type was specified");var u;if(r.isFunction(o)?u=o:u=this.types[o],!r.isFunction(u))throw new Error("validate.validators.type.types."+o+" must be a function.");if(!u(e,i,n,a,s)){var l=t.message||this.messages[o]||this.message||i.message||(r.isFunction(o)?"must be of the correct type":"must be of type %{type}");return r.isFunction(l)&&(l=l(e,t,n,a,s)),r.format(l,{attribute:r.prettify(n),type:o})}}},{types:{object:function(e){return r.isObject(e)&&!r.isArray(e)},array:r.isArray,integer:r.isInteger,number:r.isNumber,string:r.isString,date:r.isDate,boolean:r.isBoolean},messages:{}})},d.formatters={detailed:function(e){return e},flat:r.flattenErrorsToArray,grouped:function(e){var t;e=r.groupErrorsByAttribute(e);for(t in e)e[t]=r.flattenErrorsToArray(e[t]);return e},constraint:function(e){var t;e=r.groupErrorsByAttribute(e);for(t in e)e[t]=e[t].map(function(n){return n.validator}).sort();return e}},d.exposeModule(d,this,S,p,h)}).call(ue,g,f,null)})(Z,Z.exports);const P="此欄位不得為空",te=(f,g)=>`${f}必須是 ${g} 個字元`,le=f=>`${f}格式不正確`,oe=f=>`此欄位不得超過 ${f} 個字`,X="身分證字號",Y="手機號碼",L="電子郵件地址",W=()=>[f=>!!f||P],ce=()=>[f=>!!f||P,f=>f.length===10||te(X,10),f=>/^[A-Z][12]\d{8}$/.test(f)||le(X)],fe=()=>[f=>!!f||P,f=>f.length===10||te(Y,10),f=>/^09\d{8}$/.test(f)||`${Y}必須為 09 開頭的 10 位數字`],me=()=>[f=>!!f||P,f=>!f||f.length<=255||`${L}不能超過 255 個字元`,f=>!f||/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(f)||`請輸入有效的${L}`,f=>!f||/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(f)||`${L}格式不正確`],de=f=>[g=>!!g||P,g=>g.length<f||oe(f)],ge=f=>[g=>g.length>0||"請選擇圖片",g=>!g||g[0].size<=f*1024*1024||`圖片大小不能超過 ${f} MB`],he={class:"mb-2"},pe={key:0,style:{color:"red"}},ve={__name:"UserForm",props:{userFormData:{type:Object}},emits:["submit"],setup(f,{expose:g,emit:S}){const p=D(null),d=f.userFormData,r=[{id:"name",label:"姓名",required:!0,rules:W()},{id:"idNo",label:"身分證字號",required:!0,counter:10,rules:ce()},{id:"phone",label:"手機號碼",required:!0,counter:10,rules:fe()},{id:"email",label:"E-mail",required:!0,rules:me()}];return g({validate:async()=>{console.log("validate");const{valid:t}=await p.value.validate();return t}}),(t,n)=>{const a=w("v-text-field"),s=w("v-form");return E(),V(s,{ref_key:"userFormRef",ref:p},{default:b(()=>[(E(),O($,null,J(r,i=>R("div",{key:i.id,class:"mb-4"},[R("h5",he,[A(B(i.label)+" ",1),i.required?(E(),O("span",pe,"*")):q("",!0)]),x(a,{variant:"outlined",color:"var(--primary-blue)",modelValue:F(d)[i.id],"onUpdate:modelValue":o=>F(d)[i.id]=o,rules:i.rules?i.rules:[],counter:i.counter,density:"compact"},null,8,["modelValue","onUpdate:modelValue","rules","counter"])])),64))]),_:1},512)}}},ye=H(ve,[["__scopeId","data-v-04a31135"]]),_e={class:"mb-2"},xe={key:0,style:{color:"red"}},Q=50,M=100,be={__name:"UploadImage",props:{imgFormData:{type:Object},imgUrl:{type:String}},emits:["update:imgUrl"],setup(f,{expose:g,emit:S}){const p=D(null),h=f,d=S,r=h.imgFormData,e=D(null);G(e,a=>{d("update:imgUrl",a)}),G(()=>r.img,a=>{console.log("Image file:",a),a&&(e.value=URL.createObjectURL(a),console.log("Image url:",e.value))});const t=[{id:"author",label:"作者",required:!0,rules:W()},{id:"title",label:"圖片名稱",required:!0,rules:W()},{id:"description",label:`圖片敘述（最多 ${M} 字）`,required:!0,counter:M,rules:de(M)}];D(!1);const n=async()=>{const{valid:a}=await p.value.validate();return a};return re(()=>{URL.revokeObjectURL(e.value)}),g({validate:n}),(a,s)=>{const i=w("v-img"),o=w("v-icon"),u=w("v-card-text"),l=w("v-card"),c=w("v-file-input"),m=w("v-form");return E(),V(m,{ref_key:"imgFormRef",ref:p},{default:b(()=>[x(l,{class:"border mb-4","min-height":"200"},{default:b(()=>[F(r).img?(E(),V(i,{key:0,src:e.value},null,8,["src"])):(E(),V(u,{key:1},{default:b(()=>[x(o,{size:"50",class:"mb-2"},{default:b(()=>s[1]||(s[1]=[A("mdi-image")])),_:1}),R("p",null,[s[2]||(s[2]=A(" 支援格式有 png/jpg 檔，")),s[3]||(s[3]=R("br",null,null,-1)),A(" 最大限制為 "+B(Q)+" MB。 ")])]),_:1}))]),_:1}),x(c,{label:"上傳圖片",accept:"image/*","prepend-icon":"","append-inner-icon":"mdi-camera",modelValue:F(r).img,"onUpdate:modelValue":s[0]||(s[0]=y=>F(r).img=y),variant:"solo-filled",density:"compact",rules:F(ge)(Q),class:"mb-4"},null,8,["modelValue","rules"]),(E(),O($,null,J(t,y=>R("div",{key:y.id,class:"mb-4"},[R("h5",_e,[A(B(y.label)+" ",1),y.required?(E(),O("span",xe,"*")):q("",!0)]),(E(),V(ne(y.id==="description"?"v-textarea":"v-text-field"),{variant:"outlined",color:"var(--primary-blue)",modelValue:F(r)[y.id],"onUpdate:modelValue":N=>F(r)[y.id]=N,rules:y.rules||[],counter:y.counter,density:"compact"},null,8,["modelValue","onUpdate:modelValue","rules","counter"]))])),64))]),_:1},512)}}},we=H(be,[["__scopeId","data-v-e38681e5"]]),Ee=["width","height"],Se=["src"],C=450,I=20,De={__name:"PolaroidImage",props:{imgSrc:{type:String},title:{type:String},description:{type:String}},setup(f){const g=f;z({});const S=D(null),p=D(null),h=z({width:0,height:0}),d=z({width:C,height:0});ee(async()=>{g.imgSrc&&await e(g.imgSrc)}),G(()=>g.imgSrc,async u=>{u&&await e(g.imgSrc)});const r=u=>new Promise((l,c)=>{const m=new Image;m.crossOrigin="Anonymous",m.onload=()=>l(m),m.onerror=c,m.src=u}),e=async u=>{try{if(!u)return;p.value=await r(g.imgSrc||u),console.log(p.value.width,p.value.height),n(p.value.width,p.value.height),t(h.width,h.height);const l=document.createElement("canvas");l.width=d.width,l.height=d.height,console.log(d,h);const c=l.getContext("2d");a(c),s(c),i(c),S.value=l.toDataURL("image/png")}catch(l){console.error("Error generating image:",l)}},t=(u,l)=>{d.width=C,d.height=l+120},n=(u,l)=>{h.width=C-I*2,u===l?h.height=h.width:u>l?h.height=h.width*Math.max(l/u,9/16):h.height=h.width*Math.min(l/u,3/2),console.log(h)},a=u=>{u.fillStyle="GhostWhite",u.fillRect(0,0,d.width,d.height)},s=u=>{const l=h.width/p.value.width,c={width:p.value.width*l,height:p.value.height*l};console.log(p.value.width,p.value.height),console.log(h),console.log(c);const m={x:(c.width-h.width)/2,y:(c.height-h.height)/2};console.log(m),u.drawImage(p.value,m.x,m.y,h.width/l,h.height/l,I,I,h.width,h.height)},i=u=>{let l=I+h.height+40;l=o(u,g.title?g.title:"-",20,d.width-I*2,l),l+=10,o(u,g.description?g.description:"-",14,d.width-I*2,l)},o=(u,l,c,m,y)=>{u.font=`${c}px Arial`,u.fillStyle="black";const N=l.split(" ");let _="",v=c*1.2,U=y;for(let T=0;T<N.length;T++){let j=_+N[T]+" ";u.measureText(j).width>m&&T>0?(u.fillText(_,I,U),_=N[T]+" ",U+=v):_=j}return u.fillText(_,I,U),U+v};return(u,l)=>(E(),O($,null,[R("canvas",{ref:"canvas",width:d.width,height:d.height,style:{display:"none"}},null,8,Ee),S.value?(E(),O("img",{key:0,src:S.value,style:{width:"100%","box-shadow":"0 4px 8px rgba(0, 0, 0, 0.1)"}},null,8,Se)):q("",!0)],64))}},Fe={__name:"PolaroidPreview",props:{imgFormData:Object,imgUrl:String},setup(f){return(g,S)=>(E(),V(De,{imgSrc:f.imgUrl,title:f.imgFormData.title,description:f.imgFormData.description},null,8,["imgSrc","title","description"]))}},Ae={class:"button-container"},Ne={class:"button-container"},Re={__name:"UploadStepper",setup(f){const g=ie(),S={user:{idx:1,title:"基本資料填寫"},image:{idx:2,title:"圖片上傳"},polaroid:{idx:3,title:"生成拍立得"}},p=D(1),h=Object.keys(S).length;ae(()=>p.value>=h);const d=z({}),r=z({}),e=D(""),t=D(null),n=D(null),a=D(!1);ee(()=>{const c=JSON.parse(localStorage.getItem("userInfo"));c&&(d.name=c.name,d.phone=c.phone,d.email=c.email)});const s=()=>{p.value--},i=()=>{p.value++},o=async()=>{try{if(await t.value.validate()){p.value++;let m={name:d.name,phone:d.phone,email:d.email};localStorage.setItem("userInfo",JSON.stringify(m))}}catch(c){console.log(c)}},u=async()=>{try{await n.value.validate()&&p.value++}catch{}},l=async()=>{try{a.value=!0;const c=await se.postImg(d,r);console.log(c),c&&g.push({name:"UploadComplete"})}catch(c){console.log(c)}finally{a.value=!1}};return(c,m)=>{const y=w("v-stepper-item"),N=w("v-divider"),_=w("v-stepper-header"),v=w("v-btn"),U=w("v-stepper-window-item"),T=w("v-stepper-window"),j=w("v-stepper"),K=w("v-container");return E(),V(K,{class:"pa-0 mt-sm-4","max-width":"500"},{default:b(()=>[x(j,{"model-value":p.value},{default:b(()=>[x(_,null,{default:b(()=>[(E(),O($,null,J(S,k=>(E(),O($,{key:k.idx},[x(y,{title:k.title,value:k.idx},null,8,["title","value"]),k.idx<F(h)||F(h)<3?(E(),V(N,{key:0})):q("",!0)],64))),64))]),_:1}),x(T,null,{default:b(()=>[x(U,{value:S.user.idx},{default:b(()=>[x(ye,{ref_key:"userFormRef",ref:t,userFormData:d,onSubmit:i},null,8,["userFormData"]),x(v,{class:"mt-2 btn-orange",block:"",onClick:o},{default:b(()=>m[1]||(m[1]=[A(" 下一步 ")])),_:1})]),_:1},8,["value"]),x(U,{value:S.image.idx},{default:b(()=>[x(we,{ref_key:"imgFormRef",ref:n,imgFormData:r,imgUrl:e.value,"onUpdate:imgUrl":m[0]||(m[0]=k=>e.value=k),onSubmit:l},null,8,["imgFormData","imgUrl"]),R("div",Ae,[x(v,{onClick:s,variant:"tonal"},{default:b(()=>m[2]||(m[2]=[A("上一步")])),_:1}),x(v,{class:"btn-orange",onClick:u},{default:b(()=>m[3]||(m[3]=[A("下一步")])),_:1})])]),_:1},8,["value"]),x(U,{value:S.polaroid.idx},{default:b(()=>[x(Fe,{imgFormData:r,imgUrl:e.value},null,8,["imgFormData","imgUrl"]),R("div",Ne,[x(v,{onClick:s,variant:"tonal"},{default:b(()=>m[4]||(m[4]=[A("上一步")])),_:1}),x(v,{class:"btn-orange",onClick:l,loading:a.value},{default:b(()=>m[5]||(m[5]=[A("送出")])),_:1},8,["loading"])])]),_:1},8,["value"])]),_:1})]),_:1},8,["model-value"])]),_:1})}}},Oe=H(Re,[["__scopeId","data-v-675950ba"]]);export{Oe as default};
